"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1766],{1766:($,h,l)=>{l.r(h),l.d(h,{AllAndLiveCallDetailsModule:()=>N});var c=l(177),p=l(3477),r=l(5933),f=l(9417),P=l(4127),g=l(8833),v=l(8676),x=l(7482),y=l(8032),D=l.n(y),e=l(4438),b=l(9451),A=l(2408),u=l(1667);const w=["calendar"],L=()=>({display:"none"});function F(s,o){1&s&&(e.j41(0,"div",14),e.nrm(1,"ion-img",15),e.k0s())}function R(s,o){if(1&s){const i=e.RV6();e.j41(0,"ion-row",26)(1,"ion-col",27)(2,"p-dropdown",28),e.bIt("onChange",function(t){e.eBV(i);const n=e.XpG(2);return e.Njj(n.onExecutive(t))}),e.mxI("ngModelChange",function(t){e.eBV(i);const n=e.XpG(2);return e.DH7(n.selectedExecName,t)||(n.selectedExecName=t),e.Njj(t)}),e.k0s()()()}if(2&s){const i=e.XpG(2);e.R7$(2),e.Y8G("options",i.executiveslist),e.R50("ngModel",i.selectedExecName),e.Y8G("filter",!0)}}function I(s,o){if(1&s){const i=e.RV6();e.j41(0,"ion-row",29)(1,"ion-col",27)(2,"ion-button",30),e.bIt("click",function(){e.eBV(i);const t=e.XpG(2);return t.filteredParams.fromdate=t.getTodayDate(),t.filteredParams.todate=t.getTodayDate(),t.dateRange=null,t.filteredParams.isDateFilter="today",e.Njj(t.addQueryParams())}),e.j41(3,"span"),e.EFF(4),e.k0s(),e.nrm(5,"ion-icon",31),e.k0s()(),e.nrm(6,"ion-col"),e.k0s()}if(2&s){const i=e.XpG(2);e.R7$(4),e.SpI(" ",i.filteredParams.fromdate+" to "+i.filteredParams.todate,"")}}function k(s,o){if(1&s){const i=e.RV6();e.j41(0,"span")(1,"div",10)(2,"ion-row")(3,"ion-col",16),e.bIt("click",function(){e.eBV(i);const t=e.XpG();return e.Njj(t.selectDateFilter("today"))}),e.j41(4,"div",17),e.EFF(5," Today "),e.k0s()(),e.j41(6,"ion-col",16),e.bIt("click",function(){e.eBV(i);const t=e.XpG();return e.Njj(t.selectDateFilter("lastsevenDay"))}),e.j41(7,"div",18),e.EFF(8,"Last 7 days"),e.k0s()(),e.j41(9,"ion-col")(10,"div",18)(11,"label",19),e.EFF(12,"Custom"),e.k0s()()(),e.j41(13,"ion-col",20),e.bIt("click",function(){e.eBV(i);const t=e.XpG();return e.Njj(t.reset())}),e.j41(14,"div",21),e.nrm(15,"ion-icon",22),e.k0s()(),e.j41(16,"p-calendar",23,0),e.mxI("ngModelChange",function(t){e.eBV(i);const n=e.XpG();return e.DH7(n.dateRange,t)||(n.dateRange=t),e.Njj(t)}),e.bIt("onSelect",function(){e.eBV(i);const t=e.XpG();return e.Njj(t.selectDateFilter("custom"))}),e.k0s()()(),e.DNE(18,R,3,3,"ion-row",24)(19,I,7,1,"ion-row",25),e.k0s()}if(2&s){const i=e.XpG();e.R7$(4),e.Y8G("ngClass","today"===(null==i.filteredParams?null:i.filteredParams.isDateFilter)?"bg_textColor":"text_borderColor"),e.R7$(3),e.Y8G("ngClass","lastsevendays"==i.filteredParams.isDateFilter?"bg_textColor":"text_borderColor"),e.R7$(3),e.Y8G("ngClass","custom"==(null==i.filteredParams?null:i.filteredParams.isDateFilter)?"bg_textColor":"text_borderColor"),e.R7$(6),e.Y8G("ngStyle",e.lJ4(11,L))("hideOnDateTimeSelect",!0)("touchUI",!0),e.R50("ngModel",i.dateRange),e.Y8G("dateFormat","yy-mm-dd")("maxDate",i.today),e.R7$(2),e.Y8G("ngIf",i.isAdmin),e.R7$(),e.Y8G("ngIf","custom"==i.filteredParams.isDateFilter)}}function j(s,o){if(1&s&&(e.j41(0,"ion-card",32)(1,"ion-card-content",33)(2,"ion-grid")(3,"ion-row")(4,"ion-col",34)(5,"p",35),e.EFF(6," Lead Name "),e.k0s(),e.j41(7,"p",36),e.EFF(8),e.k0s(),e.j41(9,"p",37),e.EFF(10,"Last Updated"),e.k0s(),e.j41(11,"p",38),e.EFF(12),e.nI1(13,"date"),e.k0s()(),e.j41(14,"ion-col",39)(15,"p",35),e.EFF(16," Mobile Number "),e.k0s(),e.j41(17,"p",36),e.EFF(18),e.k0s()()()()()()),2&s){const i=e.XpG();e.R7$(8),e.SpI(" ",i.filteredParams.leadName," "),e.R7$(4),e.SpI("",e.i5U(13,3,i.filteredParams.lastUpdate,"dd-MMM-yyyy")," "),e.R7$(6),e.JRh(i.filteredParams.clientnum)}}function S(s,o){if(1&s&&(e.j41(0,"span")(1,"p",42),e.EFF(2,"End Time"),e.k0s(),e.j41(3,"p",43),e.EFF(4),e.k0s()()),2&s){const i=e.XpG().$implicit;e.R7$(4),e.SpI(" ",i.endtime,"")}}function T(s,o){if(1&s&&(e.j41(0,"span")(1,"p",42),e.EFF(2,"Mode of Call"),e.k0s(),e.j41(3,"p",43),e.EFF(4),e.k0s()()),2&s){const i=e.XpG().$implicit;e.R7$(4),e.SpI(" ",i.modeofcall,"")}}function E(s,o){if(1&s&&(e.j41(0,"ion-card",40)(1,"ion-card-content",33)(2,"ion-grid")(3,"ion-row")(4,"ion-col",34)(5,"p",35),e.EFF(6),e.k0s(),e.j41(7,"p",41),e.EFF(8),e.k0s(),e.j41(9,"p",42),e.EFF(10,"Start Time"),e.k0s(),e.j41(11,"p",43),e.EFF(12),e.k0s(),e.j41(13,"p",42),e.EFF(14,"Call Duration"),e.k0s(),e.j41(15,"p",43),e.EFF(16),e.k0s()(),e.j41(17,"ion-col",44)(18,"p",35),e.EFF(19),e.k0s(),e.j41(20,"p",41),e.EFF(21,"RM Executive"),e.k0s(),e.DNE(22,S,5,1,"span",9)(23,T,5,1,"span",9),e.k0s()()()(),e.j41(24,"div",45)(25,"audio",46),e.nrm(26,"source",47),e.k0s()()()),2&s){const i=o.$implicit,a=o.index,t=e.XpG();e.R7$(6),e.SpI(" ",i.leadname,""),e.R7$(2),e.JRh(i.callto),e.R7$(4),e.SpI(" ",i.starttime,""),e.R7$(4),e.SpI(" ","true"==t.filteredParams.isAllCallLogs?i.answeredtime:t.timers[a]||"00h:00m:00s",""),e.R7$(3),e.SpI(" ",i.name,""),e.R7$(3),e.Y8G("ngIf","true"==t.filteredParams.isAllCallLogs),e.R7$(),e.Y8G("ngIf","false"==t.filteredParams.isAllCallLogs),e.R7$(3),e.Y8G("src",i.filename,e.B4B)}}function M(s,o){1&s&&(e.j41(0,"ion-row",48)(1,"ion-col",48)(2,"span",6),e.EFF(3,"No call logs found..."),e.k0s()()())}let G=(()=>{var s;class o{constructor(a,t,n,d,m,C){this.menuCtrl=a,this.location=t,this.sharedService=n,this.activeRoute=d,this.router=m,this.cd=C,this.filteredParams={fromdate:"",todate:"",isDateFilter:"",execid:"",isAllCallLogs:"",callRecord:"",clientnum:"",leadName:"",lastUpdate:""},this.today=new Date,this.selectedExecName=[],this.allAndLiveCallLogs1=[],this.timers={},this.intervalIds={}}ngOnInit(){this.activeRoute.queryParams.subscribe(a=>{this.allAndLiveCallLogs1=[],this.showSpinner=!0,this.getqueryParam(),"true"==this.filteredParams.isAllCallLogs||"true"==this.filteredParams.callRecord?this.getAllCallLogs():"true"!=this.filteredParams.callRecord&&this.getLiveCallsData(),this.isAdmin="1"==localStorage.getItem("Role"),this.getexecutiveslist(),this.cd.detectChanges()})}getexecutiveslist(){this.sharedService.getexecutiveslist().subscribe(a=>{var t;this.executiveslist=a.Executiveslist,this.executiveslist=[{Name:"All",ID:null},...a.Executiveslist||[]],this.selectedExecName=null===(t=this.executiveslist)||void 0===t?void 0:t.filter((n,d)=>{if(n.ID==this.filteredParams.execid)return n}),this.selectedExecName=this.selectedExecName[0]})}onExecutive(a){this.filteredParams.execid=a.value.ID,this.addQueryParams()}reset(){this.filteredParams={fromdate:this.getTodayDate(),todate:this.getTodayDate(),isDateFilter:"today",execid:"",isAllCallLogs:this.filteredParams.isAllCallLogs,callRecord:"",clientnum:"",leadName:"",lastUpdate:""},this.selectedExecName=[],this.addQueryParams()}getAllCallLogs(){const a={loginid:localStorage.getItem("UserId"),fromcalldatetime:this.filteredParams.fromdate,tocalldatetime:this.filteredParams.todate,execid:this.filteredParams.execid?this.filteredParams.execid:"",clientnum:this.filteredParams.clientnum?this.filteredParams.clientnum:""};this.sharedService.fetchAllCallLogs(a).subscribe({next:t=>{this.showSpinner=!1,this.allAndLiveCallLogs=t.success,this.allAndLiveCallLogs1=this.allAndLiveCallLogs},error:t=>{this.showSpinner=!1}})}openEndMenu(){this.sharedService.isMenuOpen=!0,this.menuCtrl.open("end")}onBackbutton(){this.location.back()}getTodayDate(){return(new Date).toISOString().split("T")[0]}getsevenDaysAgo(){const a=new Date;return a.setDate(a.getDate()-6),a.toISOString().split("T")[0]}selectDateFilter(a){if("today"==a)this.filteredParams.isDateFilter="today",this.dateRange=[],this.filteredParams.fromdate=this.getTodayDate(),this.filteredParams.todate=this.getTodayDate();else if("lastsevenDay"==a)this.filteredParams.isDateFilter="lastsevendays",this.dateRange=[],this.filteredParams.fromdate=this.getsevenDaysAgo(),this.filteredParams.todate=this.getTodayDate();else if("custom"==a)if(this.dateRange&&this.dateRange[0]&&this.dateRange[1]){const n=new Date(this.dateRange[0]);var t;if((new Date(this.dateRange[1]).getTime()-n.getTime())/864e5>7)D().fire({title:"Please select a date range of 7 days or less.",icon:"warning",heightAuto:!1,confirmButtonText:"Ok"}).then(()=>{""!=this.filteredParams.fromdate&&""!=this.filteredParams.todate?(this.filteredParams.fromdate=this.filteredParams.fromdate,this.filteredParams.todate=this.filteredParams.todate,this.addQueryParams()):(this.filteredParams.fromdate=this.getTodayDate(),this.filteredParams.todate=this.getTodayDate(),this.filteredParams.isDateFilter="today",this.addQueryParams())});else if(2===(null===(t=this.dateRange)||void 0===t?void 0:t.length)&&null!=this.dateRange[1]){this.filteredParams.isDateFilter="custom";const O=(0,c.Yq)(this.dateRange[0],"yyyy-MM-dd","en-US"),_=(0,c.Yq)(this.dateRange[1],"yyyy-MM-dd","en-US");this.filteredParams.fromdate=O,this.filteredParams.todate="1970-01-01"!=_?_:"",this.addQueryParams()}else""!=this.filteredParams.fromdate&&""!=this.filteredParams.todate?(this.filteredParams.fromdate=this.filteredParams.fromdate,this.filteredParams.todate=this.filteredParams.todate,this.addQueryParams()):(this.filteredParams.fromdate=this.getTodayDate(),this.filteredParams.todate=this.getTodayDate(),this.filteredParams.isDateFilter="today",this.addQueryParams())}else""!=this.filteredParams.fromdate&&""!=this.filteredParams.todate?(this.filteredParams.fromdate=this.filteredParams.fromdate,this.filteredParams.todate=this.filteredParams.todate,this.addQueryParams()):(this.filteredParams.fromdate=this.getTodayDate(),this.filteredParams.todate=this.getTodayDate(),this.filteredParams.isDateFilter="today",this.addQueryParams());this.addQueryParams()}addQueryParams(){const a={};let t=!1;for(const n in this.filteredParams)if(this.filteredParams.hasOwnProperty(n)){const d=""!==this.filteredParams[n]?this.filteredParams[n]:null;this.activeRoute.snapshot.queryParams[n]!==d&&(t=!0),a[n]=d}this.router.navigate([],{queryParams:a,queryParamsHandling:"merge"})}getqueryParam(){const a=window.location.search,t={};new URLSearchParams(a).forEach((n,d)=>{t[d]=n}),Object.keys(this.filteredParams).forEach(n=>{t.hasOwnProperty(n)?this.filteredParams[n]=t[n]:"propid"==n&&"ranavPropId"in localStorage?this.filteredParams[n]="28773":"loginid"!==n&&"limit"!==n&&"limitrows"!==n&&(this.filteredParams[n]="")}),this.cd.detectChanges()}settingSelectedDate(){if(""!=this.filteredParams.fromdate){const a=new Date(this.filteredParams.fromdate),t=new Date(this.filteredParams.todate);this.dateRange=[a,t]}else""==this.filteredParams.fromdate&&(this.dateRange=[])}getLiveCallsData(){this.sharedService.fetchLiveCall(localStorage.getItem("UserId")).subscribe({next:a=>{this.showSpinner=!1,this.allAndLiveCallLogs=a.success,this.allAndLiveCallLogs1=a.success,this.allAndLiveCallLogs1.forEach((t,n)=>{this.startTimer(n.toString(),t.starttime)})},error:a=>{this.showSpinner=!1,this.allAndLiveCallLogs1=[]}})}startTimer(a,t){this.stopTimer(a);const n="string"==typeof t?new Date(t.replace(" ","T")):t;this.intervalIds[a]=setInterval(()=>{const m=Math.floor(((new Date).getTime()-n.getTime())/1e3);this.timers[a]=this.formatTime(m)},1e3)}formatTime(a){const t=Math.floor(a/3600),n=Math.floor(a%3600/60),d=a%60;return`${t.toString().padStart(2,"0")}h:${n.toString().padStart(2,"0")}m:${d.toString().padStart(2,"0")}s`}stopTimer(a){this.intervalIds[a]&&(clearInterval(this.intervalIds[a]),delete this.intervalIds[a],this.timers[a]="00:00:00 Hrs")}ngOnDestroy(){this.sharedService.dismissAllOverlays()}}return(s=o).\u0275fac=function(a){return new(a||s)(e.rXU(r._t),e.rXU(c.aZ),e.rXU(b.d),e.rXU(p.nX),e.rXU(p.Ix),e.rXU(e.gRc))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-all-and-live-call-details"]],viewQuery:function(a,t){if(1&a&&e.GBs(w,5),2&a){let n;e.mGM(n=e.lsd())&&(t.calendar=n.first)}},decls:21,vars:6,consts:[["calendar",""],["class","content_center loader",4,"ngIf"],[1,"ion-text-center"],["size","2",1,"content_center"],["name","arrow-back",2,"font-size","24px",3,"click"],["size","8"],[1,"font-size16-familyPoppins"],["size","2",1,"content_center",3,"click"],["name","menu",1,"menu_icon"],[4,"ngIf"],[1,"m-2"],["style","border: 0.8px solid #198CC7",4,"ngIf"],["class","shadow-sm rounded-2xl",4,"ngFor","ngForOf"],["class","content_center",4,"ngIf"],[1,"content_center","loader"],["src","../assets/CRMimages/animation/loader.gif",2,"width","300px","height","70px"],[3,"click"],[1,"font-size12-familyPoppins","content_center",3,"ngClass"],[1,"font-size12-familyPoppins","content_center","text_borderColor",3,"ngClass"],["for","liveCall_date_range"],["size","1.4",3,"click"],[1,"text_borderColor","content_center"],["name","refresh-outline",1,"icon-ion","font-colorBlue"],["inputId","liveCall_date_range","selectionMode","range","appendTo","body",3,"ngModelChange","onSelect","ngStyle","hideOnDateTimeSelect","touchUI","ngModel","dateFormat","maxDate"],["class","pl-2 pr-2",4,"ngIf"],["class","pl-3 pr-3",4,"ngIf"],[1,"pl-2","pr-2"],["size","6"],["optionLabel","Name","filterBy","Name","placeholder","Select a Executive",1,"exec_css",3,"onChange","ngModelChange","options","ngModel","filter"],[1,"pl-3","pr-3"],["fill","clear",1,"filterButtons",2,"margin","0",3,"click"],["slot","end","name","close",2,"font-size","20px"],[2,"border","0.8px solid #198CC7"],[1,"p-0"],["size","6",1,"p-0"],[1,"mb-0","font-size12-familyPoppins",2,"color","rgba(47, 47, 47, 1)","font-weight","400"],[1,"small","font-size12-familyPoppins","font-colorBlue"],[1,"mt-2","mb-0","font-size12-familyPoppins",2,"color","rgba(47, 47, 47, 1)","font-weight","400"],[1,"small","font-size12-familyPoppins","font-colorBlue",2,"color","rgba(47, 47, 47, 1)","font-weight","400"],["sizesize","6",1,"text-end","p-0"],[1,"shadow-sm","rounded-2xl"],[1,"small","font-size12-familyPoppins"],[1,"mt-2","mb-0","font-size12-familyPoppins"],[1,"small","font-size12-familyPoppins",2,"color","rgba(47, 47, 47, 1)","font-weight","400"],["size","6",1,"text-end","p-0"],[1,"bg-light","p-2","d-flex","align-items-center","rounded-bottom",2,"background","rgb(183 216 233) !important"],["controls","",2,"width","100% !important","height","32px !important"],["type","audio/wav",3,"src"],[1,"content_center"]],template:function(a,t){1&a&&(e.DNE(0,F,2,0,"div",1),e.j41(1,"ion-header")(2,"ion-toolbar",2)(3,"ion-row")(4,"ion-col",3)(5,"ion-icon",4),e.bIt("click",function(){return t.onBackbutton()}),e.EFF(6,"back"),e.k0s()(),e.j41(7,"ion-col",5)(8,"ion-row")(9,"ion-col")(10,"span",6),e.EFF(11),e.k0s()()()(),e.j41(12,"ion-col",7),e.bIt("click",function(){return t.openEndMenu()}),e.nrm(13,"ion-icon",8),e.k0s()()()(),e.DNE(14,k,20,12,"span",9),e.j41(15,"ion-content")(16,"div",10),e.DNE(17,j,19,6,"ion-card",11)(18,E,27,8,"ion-card",12)(19,M,4,0,"ion-row",13),e.k0s()(),e.nrm(20,"app-common-footer")),2&a&&(e.Y8G("ngIf",t.showSpinner),e.R7$(11),e.SpI(" ","true"==t.filteredParams.isAllCallLogs?"All Calls":t.filteredParams.callRecord?"Call Records":"Live Calls"," "),e.R7$(3),e.Y8G("ngIf","true"==t.filteredParams.isAllCallLogs),e.R7$(3),e.Y8G("ngIf","true"==t.filteredParams.callRecord),e.R7$(),e.Y8G("ngForOf",t.allAndLiveCallLogs1),e.R7$(),e.Y8G("ngIf",0==(null==t.allAndLiveCallLogs1?null:t.allAndLiveCallLogs1.length)))},dependencies:[c.YU,c.Sq,c.bT,c.B3,A.a,r.Jm,r.b_,r.I9,r.hU,r.W9,r.lO,r.eU,r.iq,r.KW,r.ln,r.ai,f.BC,f.vS,g.ms,u.Vv,c.vh],styles:["div.bg_textColor[_ngcontent-%COMP%], div.text_borderColor[_ngcontent-%COMP%]{padding:4px 1px;border-radius:4px;width:100%;box-shadow:0 8px 24px #959da533!important}audio[_ngcontent-%COMP%]::-webkit-media-controls-panel{background:#b7d8e9}audio[_ngcontent-%COMP%]::-webkit-media-controls-play-button{background-color:#fff;border-radius:50%}audio[_ngcontent-%COMP%]::-webkit-media-controls-current-time-display, audio[_ngcontent-%COMP%]::-webkit-media-controls-time-remaining-display{color:#727272}ion-card[_ngcontent-%COMP%]{box-shadow:0 8px 24px #959da533!important;border-radius:4px!important;border:1px solid #efefef}ion-searchbar[_ngcontent-%COMP%]{padding:6px;height:100%;border:.2px solid #bebfc8!important;border-radius:25px}  ion-searchbar.execsearch .searchbar-input-container{height:100%;display:flex;align-items:center;justify-content:center;border-radius:79px}  .searchbar-input.sc-ion-searchbar-md{--webkit-box-shadow: none;font-size:16px;color:#060606!important;font-family:Poppins}  ion-searchbar .searchbar-input{padding:0;-webkit-padding-end:0!important;-webkit-padding-start:0!important;padding-inline-end:25px!important;padding-top:0!important;padding-bottom:0!important;padding-inline-start:40px!important;border-radius:25px!important}  .loading-wrapper.sc-ion-loading-md{box-shadow:none;-webkit-box-shadow:none}.loader[_ngcontent-%COMP%]{--backdrop-opacity: .8;--background: none;--spinner-color: white;box-shadow:none;-webkit-box-shadow:none!important}.filterButtons[_ngcontent-%COMP%]{font-family:Poppins;font-weight:400;font-size:12px;color:#000;text-transform:none;height:35px;align-items:center;border:1px solid rgba(11,122,178,.5);border-radius:4px;color:#009acb}.bg_textColor[_ngcontent-%COMP%]{background:#0b7ab2!important;color:#fff!important}  p-dropdown.exec_css .p-inputwrapper span{padding:5px;font-family:Poppins}  p-dropdown.exec_css .p-inputwrapper span{padding:5px;font-size:12px;font-family:Poppins;color:#0b7ab2}  p-dropdown.exec_css .p-inputwrapper{width:100%!important;border:.5px #0b7ab2 solid}  p-dropdown.exec_css .p-inputwrapper .p-dropdown-trigger{width:30px!important}  p-dropdown.exec_css .p-inputwrapper .p-dropdown-trigger chevrondownicon{width:12px;color:#0b7ab2}  .exec_css .p-element .p-dropdown-item{padding:5px!important;font-size:12px}"]}),o})(),N=(()=>{var s;class o{}return(s=o).\u0275fac=function(a){return new(a||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[c.MD,p.iI.forChild([{path:"",component:G}]),P.G,r.bv,f.YN,g.kr,v.iV,u.rO,x.O]}),o})()}}]);