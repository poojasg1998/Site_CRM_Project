(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2321],{2321:(I,E,s)=>{"use strict";s.r(E),s.d(E,{VoiceRecorderWeb:()=>V});var N=s(5083),f=s(467),g=s(2739);const h=(0,N.F3)("BlobWriter");function D(R){return window.btoa(Array.from(new Uint8Array(R)).map(function(i){return String.fromCharCode(i)}).join(""))}function _({path:R,directory:i,blob:c,recursive:d}){return g.YA.writeFile({directory:i,path:R,recursive:d,data:""}).then(function w(){if(0===c.size)return Promise.resolve();const p=393216,r=c.slice(0,p);return c=c.slice(p),new Response(r).arrayBuffer().then(function(t){return g.YA.appendFile({directory:i,path:R,data:D(t)})}).then(w)})}const u=Object.freeze(function m(R){const{path:i,directory:c,blob:d,fast_mode:w=!1,recursive:p,on_fallback:r}=R;return d&&Number.isSafeInteger(d.size)&&"string"==typeof d.type?"web"===N.Ii.getPlatform()?w?function b({path:R,directory:i,blob:c,recursive:d}){return g.YA.writeFile({directory:i,path:R,recursive:d,data:""}).then(function(){return new Promise(function(w,p){function r(t){p(t.target.error)}const e=window.indexedDB.open("Disc");e.onerror=r,e.onsuccess=function(){const o=e.result.transaction("FileStorage","readwrite");o.onerror=r;const n=o.objectStore("FileStorage"),a=`/${i}/${R.replace(/^\//,"")}`,l=n.get(a);l.onsuccess=function(){l.result.size=c.size,l.result.content=c,n.put(l.result).onsuccess=function(){w(void 0)}}}})})}(R):_(R):Promise.all([h.get_config(),g.YA.getUri({path:i,directory:c})]).then(function([e,t]){const o=t.uri.replace("file://","");return(window.CapacitorWebFetch||window.fetch)(e.base_url+o+(p?"?recursive=true":""),{headers:{authorization:e.auth_token},method:"put",body:d}).then(function(a){if(204!==a.status)throw new Error("Bad HTTP status: "+a.status);return t.uri})}).catch(function(t){return void 0!==r&&r(t),_(R)}):Promise.reject(new Error("Not a Blob."))});var L=s(9319),O=s(5051);const F=()=>new Error("FAILED_TO_RECORD"),B=()=>new Error("RECORDING_HAS_NOT_STARTED"),z=()=>new Error("FAILED_TO_FETCH_RECORDING"),M=()=>new Error("COULD_NOT_QUERY_PERMISSION_STATUS"),C={"audio/aac":".aac","audio/mp4":".mp3","audio/webm;codecs=opus":".ogg","audio/webm":".ogg","audio/ogg;codecs=opus":".ogg"},$=()=>new Promise(()=>{});class y{constructor(){this.mediaRecorder=null,this.chunks=[],this.pendingResult=$()}static canDeviceVoiceRecord(){return(0,f.A)(function*(){var i;return null==(null===(i=null==navigator?void 0:navigator.mediaDevices)||void 0===i?void 0:i.getUserMedia)||null==y.getSupportedMimeType()?{value:!1}:{value:!0}})()}startRecording(i){var c=this;return(0,f.A)(function*(){if(null!=c.mediaRecorder)throw new Error("ALREADY_RECORDING");if(!(yield y.canDeviceVoiceRecord()).value)throw new Error("DEVICE_CANNOT_VOICE_RECORD");if(!(yield y.hasAudioRecordingPermission().catch(()=>({value:!0}))).value)throw new Error("MISSING_PERMISSION");return navigator.mediaDevices.getUserMedia({audio:!0}).then(p=>c.onSuccessfullyStartedRecording(p,i)).catch(c.onFailedToStartRecording.bind(c))})()}stopRecording(){var i=this;return(0,f.A)(function*(){if(null==i.mediaRecorder)throw B();try{return i.mediaRecorder.stop(),i.mediaRecorder.stream.getTracks().forEach(c=>c.stop()),i.pendingResult}catch{throw z()}finally{i.prepareInstanceForNextOperation()}})()}static hasAudioRecordingPermission(){return(0,f.A)(function*(){return null==navigator.permissions.query?null==navigator.mediaDevices?Promise.reject(M()):navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>({value:!0})).catch(()=>{throw M()}):navigator.permissions.query({name:"microphone"}).then(i=>({value:"granted"===i.state})).catch(()=>{throw M()})})()}static requestAudioRecordingPermission(){return(0,f.A)(function*(){return(yield y.hasAudioRecordingPermission().catch(()=>({value:!1}))).value?{value:!0}:navigator.mediaDevices.getUserMedia({audio:!0}).then(()=>({value:!0})).catch(()=>({value:!1}))})()}pauseRecording(){if(null==this.mediaRecorder)throw B();return"recording"===this.mediaRecorder.state?(this.mediaRecorder.pause(),Promise.resolve({value:!0})):Promise.resolve({value:!1})}resumeRecording(){if(null==this.mediaRecorder)throw B();return"paused"===this.mediaRecorder.state?(this.mediaRecorder.resume(),Promise.resolve({value:!0})):Promise.resolve({value:!1})}getCurrentStatus(){return Promise.resolve(null==this.mediaRecorder?{status:O.k.NONE}:"recording"===this.mediaRecorder.state?{status:O.k.RECORDING}:"paused"===this.mediaRecorder.state?{status:O.k.PAUSED}:{status:O.k.NONE})}static getSupportedMimeType(){if(null==(null==MediaRecorder?void 0:MediaRecorder.isTypeSupported))return null;const i=Object.keys(C).find(c=>MediaRecorder.isTypeSupported(c));return null!=i?i:null}onSuccessfullyStartedRecording(i,c){var d=this;return this.pendingResult=new Promise((w,p)=>{this.mediaRecorder=new MediaRecorder(i),this.mediaRecorder.onerror=()=>{this.prepareInstanceForNextOperation(),p(F())},this.mediaRecorder.onstop=(0,f.A)(function*(){var r,e,t;const o=y.getSupportedMimeType();if(null==o)return d.prepareInstanceForNextOperation(),void p(z());const n=new Blob(d.chunks,{type:o});if(n.size<=0)return d.prepareInstanceForNextOperation(),void p(new Error("EMPTY_RECORDING"));let a,l;null!=c?(a=`${null!==(t=null===(e=null===(r=c.subDirectory)||void 0===r?void 0:r.match(/^\/?(.+[^/])\/?$/))||void 0===e?void 0:e[1])&&void 0!==t?t:""}/recording-${(new Date).getTime()}${C[o]}`,yield u({blob:n,directory:c.directory,fast_mode:!0,path:a,recursive:!0})):l=yield y.blobToBase64(n);const v=yield(0,L.A)(n);d.prepareInstanceForNextOperation(),w({value:{recordDataBase64:l,mimeType:o,msDuration:1e3*v,path:a}})}),this.mediaRecorder.ondataavailable=r=>this.chunks.push(r.data),this.mediaRecorder.start()}),{value:!0}}onFailedToStartRecording(){throw this.prepareInstanceForNextOperation(),F()}static blobToBase64(i){return new Promise(c=>{const d=new FileReader;d.onloadend=()=>{const w=String(d.result),p=w.split("base64,");c((p.length>1?p[1]:w).trim())},d.readAsDataURL(i)})}prepareInstanceForNextOperation(){if(null!=this.mediaRecorder&&"recording"===this.mediaRecorder.state)try{this.mediaRecorder.stop()}catch(i){console.warn("While trying to stop a media recorder, an error was thrown",i)}this.pendingResult=$(),this.mediaRecorder=null,this.chunks=[]}}class V extends N.E_{constructor(){super(...arguments),this.voiceRecorderInstance=new y}canDeviceVoiceRecord(){return y.canDeviceVoiceRecord()}hasAudioRecordingPermission(){return y.hasAudioRecordingPermission()}requestAudioRecordingPermission(){return y.requestAudioRecordingPermission()}startRecording(i){return this.voiceRecorderInstance.startRecording(i)}stopRecording(){return this.voiceRecorderInstance.stopRecording()}pauseRecording(){return this.voiceRecorderInstance.pauseRecording()}resumeRecording(){return this.voiceRecorderInstance.resumeRecording()}getCurrentStatus(){return this.voiceRecorderInstance.getCurrentStatus()}}},9319:(I,E,s)=>{"use strict";var f=s(4976);E.A=function D(_){return b.apply(this,arguments)};var g=f(s(5230)),h=f(s(6891));function b(){return(b=(0,h.default)(g.default.mark(function _(m){var u,L;return g.default.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return u=document.createElement("video"),L=new Promise(function(S,G){u.addEventListener("loadedmetadata",function(){u.duration===1/0?(u.currentTime=Number.MAX_SAFE_INTEGER,u.ontimeupdate=function(){u.ontimeupdate=null,S(u.duration),u.currentTime=0}):S(u.duration)}),u.onerror=function(j){return G(j.target.error)}}),u.src="string"==typeof m||m instanceof String?m:window.URL.createObjectURL(m),O.abrupt("return",L);case 4:case"end":return O.stop()}},_)}))).apply(this,arguments)}},5198:I=>{var E=function(s){"use strict";var h,N=Object.prototype,f=N.hasOwnProperty,g=Object.defineProperty||function(r,e,t){r[e]=t.value},D="function"==typeof Symbol?Symbol:{},b=D.iterator||"@@iterator",_=D.asyncIterator||"@@asyncIterator",m=D.toStringTag||"@@toStringTag";function u(r,e,t){return Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{u({},"")}catch{u=function(e,t,o){return e[t]=o}}function L(r,e,t,o){var a=Object.create((e&&e.prototype instanceof W?e:W).prototype),l=new d(o||[]);return g(a,"_invoke",{value:V(r,t,l)}),a}function O(r,e,t){try{return{type:"normal",arg:r.call(e,t)}}catch(o){return{type:"throw",arg:o}}}s.wrap=L;var S="suspendedStart",G="suspendedYield",j="executing",Y="completed",A={};function W(){}function F(){}function k(){}var B={};u(B,b,function(){return this});var z=Object.getPrototypeOf,M=z&&z(z(w([])));M&&M!==N&&f.call(M,b)&&(B=M);var C=k.prototype=W.prototype=Object.create(B);function $(r){["next","throw","return"].forEach(function(e){u(r,e,function(t){return this._invoke(e,t)})})}function y(r,e){function t(a,l,v,T){var P=O(r[a],r,l);if("throw"!==P.type){var Q=P.arg,H=Q.value;return H&&"object"==typeof H&&f.call(H,"__await")?e.resolve(H.__await).then(function(U){t("next",U,v,T)},function(U){t("throw",U,v,T)}):e.resolve(H).then(function(U){Q.value=U,v(Q)},function(U){return t("throw",U,v,T)})}T(P.arg)}var o;g(this,"_invoke",{value:function n(a,l){function v(){return new e(function(T,P){t(a,l,T,P)})}return o=o?o.then(v,v):v()}})}function V(r,e,t){var o=S;return function(a,l){if(o===j)throw new Error("Generator is already running");if(o===Y){if("throw"===a)throw l;return p()}for(t.method=a,t.arg=l;;){var v=t.delegate;if(v){var T=R(v,t);if(T){if(T===A)continue;return T}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(o===S)throw o=Y,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);o=j;var P=O(r,e,t);if("normal"===P.type){if(o=t.done?Y:G,P.arg===A)continue;return{value:P.arg,done:t.done}}"throw"===P.type&&(o=Y,t.method="throw",t.arg=P.arg)}}}function R(r,e){var t=e.method,o=r.iterator[t];if(o===h)return e.delegate=null,"throw"===t&&r.iterator.return&&(e.method="return",e.arg=h,R(r,e),"throw"===e.method)||"return"!==t&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+t+"' method")),A;var n=O(o,r.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,A;var a=n.arg;return a?a.done?(e[r.resultName]=a.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=h),e.delegate=null,A):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,A)}function i(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function c(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function d(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(i,this),this.reset(!0)}function w(r){if(r){var e=r[b];if(e)return e.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var t=-1,o=function n(){for(;++t<r.length;)if(f.call(r,t))return n.value=r[t],n.done=!1,n;return n.value=h,n.done=!0,n};return o.next=o}}return{next:p}}function p(){return{value:h,done:!0}}return F.prototype=k,g(C,"constructor",{value:k,configurable:!0}),g(k,"constructor",{value:F,configurable:!0}),F.displayName=u(k,m,"GeneratorFunction"),s.isGeneratorFunction=function(r){var e="function"==typeof r&&r.constructor;return!!e&&(e===F||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,k):(r.__proto__=k,u(r,m,"GeneratorFunction")),r.prototype=Object.create(C),r},s.awrap=function(r){return{__await:r}},$(y.prototype),u(y.prototype,_,function(){return this}),s.AsyncIterator=y,s.async=function(r,e,t,o,n){void 0===n&&(n=Promise);var a=new y(L(r,e,t,o),n);return s.isGeneratorFunction(e)?a:a.next().then(function(l){return l.done?l.value:a.next()})},$(C),u(C,m,"Generator"),u(C,b,function(){return this}),u(C,"toString",function(){return"[object Generator]"}),s.keys=function(r){var e=Object(r),t=[];for(var o in e)t.push(o);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},s.values=w,d.prototype={constructor:d,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(c),!r)for(var e in this)"t"===e.charAt(0)&&f.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=h)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function t(T,P){return a.type="throw",a.arg=r,e.next=T,P&&(e.method="next",e.arg=h),!!P}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],a=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var l=f.call(n,"catchLoc"),v=f.call(n,"finallyLoc");if(l&&v){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(l){if(this.prev<n.catchLoc)return t(n.catchLoc,!0)}else{if(!v)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}}},abrupt:function(r,e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&f.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===r||"continue"===r)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=r,a.arg=e,n?(this.method="next",this.next=n.finallyLoc,A):this.complete(a)},complete:function(r,e){if("throw"===r.type)throw r.arg;return"break"===r.type||"continue"===r.type?this.next=r.arg:"return"===r.type?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):"normal"===r.type&&e&&(this.next=e),A},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),c(t),A}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===r){var o=t.completion;if("throw"===o.type){var n=o.arg;c(t)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,t){return this.delegate={iterator:w(r),resultName:e,nextLoc:t},"next"===this.method&&(this.arg=h),A}},s}(I.exports);try{regeneratorRuntime=E}catch{"object"==typeof globalThis?globalThis.regeneratorRuntime=E:Function("r","regeneratorRuntime = r")(E)}},6891:I=>{function E(N,f,g,h,D,b,_){try{var m=N[b](_),u=m.value}catch(L){return void g(L)}m.done?f(u):Promise.resolve(u).then(h,D)}I.exports=function s(N){return function(){var f=this,g=arguments;return new Promise(function(h,D){var b=N.apply(f,g);function _(u){E(b,h,D,_,m,"next",u)}function m(u){E(b,h,D,_,m,"throw",u)}_(void 0)})}}},4976:I=>{I.exports=function E(s){return s&&s.__esModule?s:{default:s}}},5230:(I,E,s)=>{I.exports=s(5198)}}]);